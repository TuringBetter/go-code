# 端口转发问题调试记录

## 问题描述

云服务器运行服务后，本地浏览器访问 `http://localhost:8080` 无法加载。

---

## 问题排查

### 1. 检查本地端口占用情况

```powershell
PS C:\Users\**\Desktop> netstat -ano | findstr :8080
  TCP    127.0.0.1:3449         127.0.0.1:8080         FIN_WAIT_2      47584
  TCP    127.0.0.1:3968         127.0.0.1:8080         FIN_WAIT_2      47524
  TCP    127.0.0.1:4296         127.0.0.1:8080         FIN_WAIT_2      47524
  TCP    127.0.0.1:5854         127.0.0.1:8080         FIN_WAIT_2      47584
  TCP    127.0.0.1:8080         0.0.0.0:0              LISTENING       12496
  TCP    127.0.0.1:8080         127.0.0.1:3449         CLOSE_WAIT      12496
  TCP    127.0.0.1:8080         127.0.0.1:3968         CLOSE_WAIT      12496
  TCP    127.0.0.1:8080         127.0.0.1:4296         CLOSE_WAIT      12496
  TCP    127.0.0.1:8080         127.0.0.1:5854         CLOSE_WAIT      12496
  TCP    127.0.0.1:8080         127.0.0.1:8524         CLOSE_WAIT      12496
  TCP    127.0.0.1:8080         127.0.0.1:10565        CLOSE_WAIT      12496
  TCP    127.0.0.1:8080         127.0.0.1:11907        CLOSE_WAIT      12496
  TCP    127.0.0.1:8524         127.0.0.1:8080         FIN_WAIT_2      47584
  TCP    127.0.0.1:10565        127.0.0.1:8080         FIN_WAIT_2      48932
  TCP    127.0.0.1:11907        127.0.0.1:8080         FIN_WAIT_2      48232
  TCP    192.168.1.104:2439     157.148.57.99:8080     ESTABLISHED     16120
  TCP    198.18.0.1:8408        43.130.30.247:8080     ESTABLISHED     16084
```

### 2. 问题分析

**核心问题：** 本地 8080 端口正在监听（PID 12496），但有大量连接处于 `CLOSE_WAIT` 状态。

**诊断结果：**
- ✅ 端口转发正常（本地 8080 在监听）
- ✅ SSH 连接正常
- ❌ 之前的 HTTP 连接没有正常关闭，堆积了很多半关闭状态的连接

### 3. 确认占用进程

```powershell
PS C:\Users\xr\Desktop> Get-Process -Id 12496 | Select-Object Name,Path

Name   Path
----   ----
Cursor D:\Program\cursor\Cursor.exe
```

**结论：** 端口被 Cursor 进程占用，处于端口转发状态。

---

## 解决方案

### 在 Cursor 中重启端口转发

1. 在 Cursor 中按 `Ctrl+Shift+P`（或 `F1`）
2. 输入并选择：**Ports: Focus on Ports View**  
   （或直接点击底部状态栏的"端口"图标）
3. 在端口列表中找到 `8080`
4. 右键点击 → 选择 **"停止转发端口"** 或 **"Stop Forwarding Port"**
5. 等待几秒后，再次右键 → 选择 **"转发端口 8080"**  
   （或直接刷新浏览器，Cursor 可能会自动重新转发）